# å®Œæˆäº‹é¡¹</font>
+ å¤ä¹ cè¯­è¨€
+ éƒ¨åˆ†æ±‡ç¼–å­¦ä¹ 
+ åšé¢˜
# ä¸‹å‘¨å¾…åšäº‹é¡¹</font>
+ ç»§ç»­å­¦æ±‡ç¼–,åšé¢˜
# æœ¬å‘¨å­¦ä¹ çš„çŸ¥è¯†åˆ†äº«</font>
## ereere
+ è¿™é“é¢˜è®©æˆ‘æ„è¯†åˆ°äº†æœ‰æ—¶å€™å·²çŸ¥ä¿¡æ¯éƒ½ä¸ä¼šå¾ˆç›´æ¥åœ°å‘ˆç°ç»™ä½ ,å¯¹å¸¸ç”¨å‡½æ•°å’Œé¢˜ç›®å½¢çŠ¶è¿˜éœ€è¦æœ‰ä¸€ä¸ªå¤§æ¦‚çš„è®¤çŸ¥
+ çœ‹çœ‹è¿™ä¸ªbydçš„åŸå§‹ä»£ç å§
+ æ‰“å¼€æ‰¾ä¸åˆ°main,æ‰«ä¸€çœ¼,é‚£å°±åªèƒ½æ˜¯startäº†
```
void __noreturn start()
{
  int p_sub_4015C8; // $v0
  int v1; // [sp-10h] [-20h] BYREF
  int v2; // [sp+10h] [+0h]
  char v3; // [sp+14h] [+4h] BYREF

  sub_400D30(
    (int (__fastcall *)(int, int, int))sub_400BC8,
    v2,
    (int)&v3,
    (void (__fastcall *)(int, int, int))init_proc_w,
    (int)sub_4015C8,
    p_sub_4015C8,
    (int)&v1);
}
```
+ å¥½æ ·çš„ğŸ‘åŸæ¥æ˜¯æˆ‘æ‰¾é”™å‡½æ•°äº†å•Šå“ˆå“ˆ,æ‰“æ‰°äº†æ‰“æ‰°äº†
+ ............é›†è´¸å•Š?!æ‰¾å…¶ä»–æ›´éº»çƒ¦äº†,å°±ä¸€ä¸ªä¸€ä¸ªçœ‹å§
+ ç¿»äº†ç¿»ç»ˆäºæ‰¾åˆ°ä¸€ä¸ªåˆå…·äººå½¢çš„
```
int sub_400BC8()
{
  int result; // $v0
  int v1; // [sp+18h] [+18h]
  int v2; // [sp+1Ch] [+1Ch]
  char v3[100]; // [sp+20h] [+20h] BYREF
  int v4; // [sp+84h] [+84h]

  v4 = dword_49E990;
  sub_408940("please input your flag:");
  sub_408A40("%s", v3);
  v1 = sub_41A6E0(v3);
  sub_4009DC(v3);
  v2 = sub_400550(v3, v1);
  if ( sub_41A1E0(v2, "ScDZC1cNDZaxnh/2eW1UdqaCiJ0ijRIExlvVEgP43rpxoxbYePBhpwHDPJ==") )
  {
    sub_4098B0("wrong!");
    result = -1;
  }
  else
  {
    sub_4098B0("correct!");
    result = 0;
  }
  if ( v4 != dword_49E990 )
    sub_420350();
  return result;
}
```
+ å¥½å§å…¶å®ä¹Ÿä¸å’‹åƒäºº,ä½†æ˜¯è¿™è‚¯å®šå°±æ˜¯ä¸»å¹²å‡½æ•°äº†
+ ä¸è¿‡è¿™äº›å‡½æ•°é•¿å¾—æœ‰ç‚¹å¥‡æ€ª,ä¸€ä¸ªä¸ªå…¨è·Ÿè¿›å»å‘ç°æ˜¯å¾ˆå¤æ‚çš„æ“ä½œ,ä¸å¯èƒ½æ˜¯è®©æˆ‘åšè¿™äº›çš„é€†è¿ç®—å§?
+ ä½†æ˜¯è¿™ä¸ªé¢˜çš„å¤§ä½“å½¢çŠ¶é•¿å¾—å¾ˆæ¨¡æ¿
+ æ‰€ä»¥æ ¹æ®æˆ‘çš„çŒœæµ‹å’Œä¸å¤§dè€å¸ˆçš„äº²åˆ‡äº¤æµ,æˆ‘ç»ˆäºè¿˜åŸäº†è¿™ä¸ªå‡½æ•°
```
int main()
{
  int result; // $v0
  int v1; // [sp+18h] [+18h]
  int v2; // [sp+1Ch] [+1Ch]
  char v3[100]; // [sp+20h] [+20h] BYREF
  int v4; // [sp+84h] [+84h]

  v4 = dword_49E990;
  printf("please input your flag:");
  scanf("%s", v3);
  v1 = strlen(v3);
  RC4(v3);
  v2 = base64_encode(v3, v1);
  if ( strcmp(v2, "ScDZC1cNDZaxnh/2eW1UdqaCiJ0ijRIExlvVEgP43rpxoxbYePBhpwHDPJ==") )
  {
    puts("wrong!");
    result = -1;
  }
  else
  {
    puts("correct!");
    result = 0;
  }
  if ( v4 != dword_49E990 )
    sub_420350();
  return result;
}
```
+ æˆ‘å»,è¿™ä¸‹çœ‹æ‡‚äº† æç„¶å¤§æ‚Ÿ èŒ…å¡é¡¿å¼€ é†é†çŒé¡¶ å¦‚æ¢¦åˆé†’ è±ç„¶å¼€æœ— å¤§å½»å¤§æ‚Ÿ æ°´è½çŸ³å‡º å¹¡ç„¶é†’æ‚Ÿ é‡‘ç¯¦åˆ®ç›® æ™¨é’Ÿæš®é¼“ å½“å¤´æ£’å– å‘äººæ·±æ€
+ sub_420350é‡Œé¢æ˜¯ç©ºçš„,æ˜¯ç”¨æ¥å¹²å•¥çš„æˆ‘ç°åœ¨è¿˜ä¸çŸ¥é“
+ ä¸è¿‡ç°åœ¨å¤§ä½“ä¸Šæˆ‘ä»¬ç¡®å®å¯ä»¥æ„‰å¿«åœ°é€†å‘äº†
+ é¦–å…ˆç»™äº†v4ä¸€ä¸ªå€¼,è·Ÿè¿›å»åœ¨æ±‡ç¼–é¡µé¢å‘ç°æ˜¯ä¹±çš„,ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨,å…ˆä¸ç®¡å®ƒ
+ æ¥ä¸‹æ¥è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²v3,è®¡ç®—å…¶é•¿åº¦èµ‹å€¼ç»™v1,æ¥ä¸‹æ¥æŠŠè¿™ä¸ªå­—ç¬¦ä¸²ä¼ ç»™äº†ä¸‹é¢çš„RC4åŠ å¯†å‡½æ•°
+ æ¥ä¸‹æ¥æŠŠå¾—åˆ°çš„v3å’Œv1ä¸€èµ·ä¼ è¿›äº†base64åŠ å¯†å‡½æ•°
+ åŠ å¯†å‡ºæ¥ä¹‹åå’Œåé¢çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒç›¸ç­‰å°±æ­£ç¡®äº†
+ é‚£é€†å‘æ€è·¯å°±å¾ˆæ˜ç¡®äº†æŠŠè¿™ä¸²å­—ç¬¦è§£ç ä¹‹åæ‰”å›rc4é‡Œè§£å‡ºæ¥å°±æ˜¯flagäº†
+ æ‰¾key
```
BOOL sub_400864()
{
  BOOL result; // $v0
  unsigned int n0x100; // [sp+18h] [+18h]
  unsigned int n0x100_1; // [sp+18h] [+18h]
  int _flag_123321321123badbeef012__; // [sp+1Ch] [+1Ch]
  int v4; // [sp+20h] [+20h]
  unsigned __int8 v5; // [sp+27h] [+27h]

  for ( n0x100 = 0; n0x100 < 0x100; ++n0x100 )
    byte_4A0860[n0x100] = n0x100;
  v4 = 0;
  LOBYTE(_flag_123321321123badbeef012__) = 0;
  for ( n0x100_1 = 0; ; ++n0x100_1 )
  {
    result = n0x100_1 < 0x100;
    if ( n0x100_1 >= 0x100 )
      break;
    v5 = byte_4A0860[n0x100_1];
    _flag_123321321123badbeef012__ = (unsigned __int8)(v5 + _flag_123321321123badbeef012__ + aFlag1233213211[v4]);// "flag{123321321123badbeef012}"
    byte_4A0860[n0x100_1] = byte_4A0860[_flag_123321321123badbeef012__];
    byte_4A0860[_flag_123321321123badbeef012__] = v5;
    if ( ++v4 >= (unsigned int)sub_41A6E0(aFlag1233213211) )// "flag{123321321123badbeef012}"
      v4 = 0;
  }
  return result;
}
```
+ é‚£è¿˜è¯´å•¥äº†,éƒ½æ‰¾è¿™æ¥äº†keyç»™ä½ ä¸å°±æ˜¯äº†?flag{123321321123badbeef012}
+ å¼€å§‹è§£ç ä¹‹å‰ç…ä¸€çœ¼ç è¡¨,ç›´æ¥shift + f12,å‘ç°å¯ç–‘å­—ç¬¦
+ .rodata:00473E00	00000041	C	ZYXWVUTSRQPONMLKJIHGFEDCBAabcdefghijklmnopqrstuvwxyz/+9876543210
+ æ”¹è¡¨è§£ç å¾—åˆ°Ã…Â€_Ã§XÂ±Â=x?Â…vÂ¦Â—Â‰Ã¢ÂŒÂ„UÃ†[Ã„VÂ»Ã²ÂºqÂ£ÃxÂ¦!Â§Â–)
+ å•Šå•¦å•Šå•¦,è¿™å°±æœ‰ç‚¹ä¼¤è„‘ç­‹äº†å‘¢,è¿™ä¸œè¥¿çœŸèƒ½å¡å¯†æ–‡é‡Œé¢å—?
+ ç®—äº†,äº¤ç»™èµ›åšå¨å­å§,æŠŠè¿™ä¸²ç¥ç§˜ç¬¦æ–‡å–‚ç»™cyberchef,to hex,å¾—åˆ°äº†1d c5 80 5f e7 0c 58 06 b1 9e 1d 3d 78 3f 85 76 a6 97 89 0f e2 8c 84 55 c6 5b c4 56 02 bb f2 ba 71 a3 16 c1 78 a6 21 a7 04 96 29
+ åŠ ä¸Š0xä¹‹åæ”¾è¿›å“ˆçº³ä¼æ‰“çš„è§£å¯†å‡½æ•°é‡Œ
```
#include <stdio.h>  
#include <stdlib.h>  
  
void swap(unsigned char* a, unsigned char* b) // äº¤æ¢ä¸¤ä¸ªå­—èŠ‚  
{  
    unsigned char temp = *a;  
    *a = *b;  
    *b = temp;  
}  
  
void RC4_enc(unsigned char* plaintext, int length, const char* key)  // RC4åŠ å¯†å‡½æ•°  
{  
    int i, j;  
    unsigned char* S;  
    unsigned char k[256];  
    int keylen = 0;  
      
    while (key[keylen] != '\0')   
    {  
        keylen++;  
    }// è®¡ç®—å¯†é’¥é•¿åº¦  
  
    for (i = 0; i < 256; i++)   
    {      
        k[i] = key[i % keylen];  
    }    // åˆå§‹åŒ–å¯†é’¥æ•°ç»„k  
  
    S = (unsigned char*)malloc(256 * sizeof(unsigned char));      
    for (i = 0; i < 256; i++) {  
        S[i] = i;  
    }// åˆå§‹åŒ–Sç›’  
  
    j = 0;  
    for (i = 0; i < 256; i++) {  
        j = (j + S[i] + k[i]) % 256;  
        swap(&S[i], &S[j]);  
    }// æ‰“ä¹±Sç›’  
  
    i = 0;  
    j = 0;  
    for (int n = 0; n < length; n++) {  
        i = (i + 1) % 256;  
        j = (j + S[i]) % 256;  
        swap(&S[i], &S[j]);  
        int t = (S[i] + S[j]) % 256;  
        plaintext[n] ^= S[t];  
    }// è¿›è¡ŒåŠ å¯†  
  
    free(S);  
}  
  
int main() {  
    unsigned char plaintext[] =   
    {  
        0x1d,0xc5,0x80,0x5f,0xe7,0x0c,0x58,0x06,0xb1,0x9e,0x1d,0x3d,0x78,0x3f,0x85,0x76,0xa6,0x97,0x89,0x0f,0xe2,0x8c,0x84,0x55,0xc6,0x5b,0xc4,0x56,0x02,0xbb,0xf2,0xba,0x71,0xa3,0x16,0xc1,0x78,0xa6,0x21,0xa7,0x04,0x96,0x29 
    };//æ­¤å¤„ä¸ºå¯†æ–‡  
    const char key[] = "flag{123321321123badbeef012}";  //æ­¤å¤„ä¸ºç§˜é’¥  
    RC4_enc(plaintext, sizeof(plaintext), key);  
  
    for (int i = 0; i < sizeof(plaintext); i++)  
        printf("%02X ", plaintext[i]);  
    printf("\n");    // è¾“å‡ºåŠ å¯†åçš„å¯†æ–‡  
  
    return 0;  
}  
```
+ å¾—åˆ°66 6C 61 67 7B 52 43 5F 66 30 75 72 5F 41 6E 64 5F 42 61 73 65 5F 73 31 78 74 79 5F 66 30 75 72 5F 45 6E 63 72 79 70 74 5F 21 7D
+ ç»§ç»­å–‚ç»™cyberchef,from hex,å¾—åˆ°
+ flag{RC_f0ur_And_Base_s1xty_f0ur_Encrypt_!}
+ åœ†æ»¡ç»“æŸ!å®Œç»“æ’’èŠ±!
+ ..........äº†å—?
## å‡½æ•°çš„è¯†åˆ«
+ åˆšåˆšåªæ˜¯å¾ˆç²—ç•¥çš„è§£é¢˜è¿‡ç¨‹,å…¶å®å½“æˆ‘ç ”ç©¶å®Œè¿™é“é¢˜ä¹‹åå°±è¢«æ·±æ·±éœ‡æ’¼äº†,ä¸–ç•Œä¸Šæ€ä¹ˆä¼šæœ‰è¿™ä¹ˆé‡èº«æ‰“é€ çš„é¢˜ç›®?ä¸ä»…å¤ä¹ äº†ä¸Šä¸€å‘¨å“ˆçº³ä¼æ‰“å¸ƒç½®çš„ä»»åŠ¡,å·©å›ºäº†rc4çš„è¯†åˆ«å’Œä½¿ç”¨,è€Œä¸”è¿˜é™„å¸¦äº†æ–°çš„çŸ¥è¯†,å¹¶ä¸”æ˜¯å¯¹å‰å¾€ä¸‹ä¸€æ­¥å­¦ä¹ å¾ˆæœ‰ç”¨çš„å‡½æ•°è¯†åˆ«,é‚£æ—¶æˆ‘ä¾¿æ˜ç™½,è¿™é“é¢˜è¦å¥½å¥½ç ”ç©¶æ‰è¡Œ
### æ‰“å°ç±»å‡½æ•°
+ ä¸Šé¢æœ‰ä¸¤ä¸ªè¾“å‡º,ä¸€ä¸ªæ˜¯printf,ä¸€ä¸ªæ˜¯puts
+ 408940æ˜¯printf,æ”¯æŒæ ¼å¼å­—ç¬¦ä¸²(å°±æ˜¯èƒ½æ¢å†…å®¹),ä¸è‡ªåŠ¨æ·»åŠ æ¢è¡Œç¬¦
+ 4098B0æ˜¯puts,ç”¨äºå­—ç¬¦ä¸²è¾“å‡ºä¸”è‡ªåŠ¨æ¢è¡Œ,å¸¸ç”¨äºå•ä¸ªå­—ç¬¦ä¸²çš„è¾“å‡º,ä¸å¯æ”¹å˜
+ ä»–ä»¬å…±æœ‰çš„ç‰¹å¾ç»“æ„é•¿è¿™æ ·
```
// å…¸å‹æ‰“å°å‡½æ•°éª¨æ¶
for (éå†æ•°æ®) {
    if (ç¼“å†²åŒºæ£€æŸ¥) { åˆ·æ–°æ“ä½œ }
    å­—ç¬¦å¤„ç†;
    *æŒ‡é’ˆ++ = å­—ç¬¦;
    if (ç»ˆæ­¢æ¡ä»¶) break;
}
ç³»ç»Ÿè°ƒç”¨å†™å…¥;
return è®¡æ•°;
```
### strlen
+ è¿™ä¸ªä¹Ÿæ˜¯ç‚¹è¿›å»ä¹‹åçŒœå‡ºæ¥çš„,åŸå› æ˜¯ä¸­é—´é‚£ä¸€æ®µé•¿åº¦é€’å¢å¤ªå¯ç–‘äº†,åæ¥å»å’Œå¤§däº¤æµäº†ä¸€ä¸‹,å¾—åˆ°strlenè¿˜å…·æœ‰ä»¥ä¸‹ç‰¹å¾
+ if ( !*a1 ) return (char *)(a1 - v1);
+ æœ€å…³é”®çš„è¯æ®ï¼šæ£€æŸ¥å­—ç¬¦æ˜¯å¦ä¸º0ï¼ˆnullç»ˆæ­¢ç¬¦ï¼‰ï¼Œç„¶åè¿”å› å½“å‰ä½ç½® - èµ·å§‹ä½ç½®ï¼Œè¿™æ­£æ˜¯å­—ç¬¦ä¸²é•¿åº¦çš„è®¡ç®—æ–¹å¼ã€‚
+ ä¸­é—´çš„é‚£ä¸€å—å«æŒ‡é’ˆå·®å€¼è®¡ç®—,æ˜¯strlençš„å…¸å‹å®ç°æ–¹å¼
```
if ( ((*(_DWORD *)a1 - 16843009) & ~*(_DWORD *)a1 & 0x80808080) != 0 )
      {
        if ( !*a1 )
          return (char *)(a1 - v1);
        if ( !a1[1] )
          return (char *)(a1 - v1 + 1);
        if ( !a1[2] )
          return (char *)(a1 - v1 + 2);
        if ( !a1[3] )
          return (char *)(a1 - v1 + 3);
      }
```
### strcmp
+ å’Œscanfç±»ä¼¼,æˆ‘ä¹Ÿæ˜¯é ç»“æ„çŒœå‡ºæ¥çš„,ç‚¹è¿›å»ä¹‹åå°±å¤ªç¡®ä¿¡äº†
```
if ( (((unsigned __int8)a1 | (unsigned __int8)a2) & 3) != 0 )
  {
    while ( 1 )
    {
      v9 = *a1;
      v10 = *a2;
      if ( !*a1 )
        return v9 - v10;
      v11 = a1[1];
      if ( v9 != v10 )
        return v9 - v10;
      v12 = a2[1];
      if ( !a1[1] )
        break;
      v9 = a1[2];
      if ( v11 != v12 )
        break;
      v10 = a2[2];
      if ( !a1[2] )
        return v9 - v10;
      v11 = a1[3];
      if ( v9 != v10 )
        return v9 - v10;
      v12 = a2[3];
      if ( !a1[3] )
        return v11 - v12;
      v9 = a1[4];
      if ( v11 != v12 )
        return v11 - v12;
      v10 = a2[4];
      ...............................................
```
+ é€šç¯‡éƒ½æ˜¯ç±»ä¼¼äºè¿™æ ·çš„ä¸œè¥¿,å®Œå…¨å°±æ˜¯åœ¨é€å­—èŠ‚æ¯”è¾ƒå•Š
### base64
+ é‚£ä¹ˆé¦–å…ˆåœ¨å¤–ä¾§ä¼ è¿›å»äº†å€¼å’Œé•¿åº¦,è·Ÿè¿›ä¹‹åå‘ç°è¿™æ ·çš„ç»“æ„
```
_DWORD *__fastcall sub_400550(unsigned __int8 *a1, int n2_1)
{
  int v2; // $v0
  int v3; // $v0
  int v4; // $v0
  int v5; // $v0
  int v6; // $v0
  unsigned __int8 *v8; // [sp+1Ch] [+1Ch]
  int n2; // [sp+20h] [+20h]
  int v10; // [sp+24h] [+24h]
  int v11; // [sp+24h] [+24h]
  int v12; // [sp+24h] [+24h]
  _DWORD *v13; // [sp+2Ch] [+2Ch]

  v13 = sub_418210(4 * n2_1 / 3 + 1);
  v10 = 0;
  v8 = a1;
  for ( n2 = n2_1; n2 > 0; n2 -= 3 )
  {
    v2 = v10;
    v11 = v10 + 1;
    *((_BYTE *)v13 + v2) = aZyxwvutsrqponm[*v8 >> 2];
    if ( n2 < 2 )
    {
      *((_BYTE *)v13 + v11) = aZyxwvutsrqponm[(16 * *v8) & 0x30];
      *((_BYTE *)v13 + v11 + 1) = 61;
      v6 = v11 + 2;
      v10 = v11 + 3;
      *((_BYTE *)v13 + v6) = 61;
      break;
    }
    v3 = v11;
    v12 = v11 + 1;
    *((_BYTE *)v13 + v3) = aZyxwvutsrqponm[(16 * *v8) & 0x30 | (v8[1] >> 4)];
    if ( n2 < 3 )
    {
      *((_BYTE *)v13 + v12) = aZyxwvutsrqponm[(4 * v8[1]) & 0x3C];
      v5 = v12 + 1;
      v10 = v12 + 2;
      *((_BYTE *)v13 + v5) = 61;
      break;
    }
    *((_BYTE *)v13 + v12) = aZyxwvutsrqponm[(4 * v8[1]) & 0x3C | (v8[2] >> 6)];
    v4 = v12 + 1;
    v10 = v12 + 2;
    *((_BYTE *)v13 + v4) = aZyxwvutsrqponm[v8[2] & 0x3F];
    v8 += 3;
  }
  *((_BYTE *)v13 + v10) = 0;
  return v13;
}
```
+ å‘ç°ç è¡¨,å‘ç°å¤§é‡4çš„å€æ•°,å‘ç°å¤§é‡åç§»å’Œä¸è¿ç®—
+ æŸ¥çœ‹ç è¡¨è§‚å¯Ÿå®šä¹‰åŸŸ,ç¡®å®šå°±æ˜¯base64
### RC4
+ å®è¯è¯´æˆ‘ä¸€å¼€å§‹è¿˜å¾ˆæ²¡å‘ç°,æ¯•ç«Ÿæˆ‘ä¹Ÿæ²¡æƒ³åˆ°ä¼šè¿™ä¹ˆå·§,åˆšå­¦å®Œå°±é‡åˆ°
```
BOOL __fastcall sub_4009DC(char *a1)
{
  BOOL result; // $v0
  unsigned int i; // [sp+1Ch] [+1Ch]
  int v3; // [sp+20h] [+20h]
  int v4; // [sp+24h] [+24h]
  unsigned __int8 v5; // [sp+2Bh] [+2Bh]

  sub_400864();
  v4 = 0;
  v3 = 0;
  for ( i = 0; ; ++i )
  {
    result = i < (unsigned int)sub_41A6E0(a1);
    if ( !result )
      break;
    v3 = (v3 + 1) % 256;
    v4 = (byte_4A0860[v3] + v4) % 256;
    v5 = byte_4A0860[v3];
    byte_4A0860[v3] = byte_4A0860[v4];
    byte_4A0860[v4] = v5;
    a1[i] ^= byte_4A0860[(unsigned __int8)(byte_4A0860[v3] + byte_4A0860[v4])];
  }
  return result;
}
```
+ è§‚å¯Ÿåˆ°å‰é¢å®šä¹‰å®Œä¸œè¥¿åé¢ç«‹åˆ»å°±è°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°(å…¶å®æ˜¯RSA)
+ å¾€ä¸‹çœ‹resulté‚£ä¸€å—çš„æ„æ€å°±æ˜¯å½“i<åé¢çš„æ•°å€¼æ—¶æ‰§è¡Œä¸‹é¢çš„ç®—æ³•
+ è·Ÿè¿›å»ä¸€çœ‹,æˆ‘å»,æ€ä¹ˆè¿™ä¹ˆçœ¼ç†Ÿå•Š?è¿™ä¸å°±æ˜¯strlenå—?
+ ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€ä¸ªæ•°å€¼çš„é•¿åº¦ä¹‹å†…è¿›è¡Œè¿™ä¸ªç®—æ³•
+ å¾€ä¸‹çœ‹åˆ°256äº†,æœ€åä¸€æ­¥æ˜¯ä¸€ä¸ªå¼‚æˆ–è¿ç®—
+ æ€€ç–‘åœ¨è¿™ä¸€åˆ»äº§ç”Ÿ,é©¬è¨å¡----?
+ è·Ÿè¿›å¼€å¤´çš„é‚£ä¸ªå‡½æ•°
```
BOOL sub_400864()
{
  BOOL result; // $v0
  unsigned int n0x100; // [sp+18h] [+18h]
  unsigned int n0x100_1; // [sp+18h] [+18h]
  int _flag_123321321123badbeef012__; // [sp+1Ch] [+1Ch]
  int v4; // [sp+20h] [+20h]
  unsigned __int8 v5; // [sp+27h] [+27h]

  for ( n0x100 = 0; n0x100 < 0x100; ++n0x100 )
    byte_4A0860[n0x100] = n0x100;
  v4 = 0;
  LOBYTE(_flag_123321321123badbeef012__) = 0;
  for ( n0x100_1 = 0; ; ++n0x100_1 )
  {
    result = n0x100_1 < 0x100;
    if ( n0x100_1 >= 0x100 )
      break;
    v5 = byte_4A0860[n0x100_1];
    _flag_123321321123badbeef012__ = (unsigned __int8)(v5 + _flag_123321321123badbeef012__ + aFlag1233213211[v4]);// "flag{123321321123badbeef012}"
    byte_4A0860[n0x100_1] = byte_4A0860[_flag_123321321123badbeef012__];
    byte_4A0860[_flag_123321321123badbeef012__] = v5;
    if ( ++v4 >= (unsigned int)sub_41A6E0(aFlag1233213211) )// ""
      v4 = 0;
  }
  return result;
}
```
+ æˆ‘ç»ˆäºé‡Šæ€€åœ°ç¬‘äº†,å‘ç°0x100=256
+ å‘ç°åœ¨æ‰“ä¹±æ­¥ä¸­è¢«ä½¿ç”¨çš„å¯†é’¥flag{123321321123badbeef012}
+ ç¡®è®¤RC4,over
## chall
+ è¿›æ¥ç›´å¥”mainå‡½æ•°
```
int __fastcall main(int argc, const char **argv, const char **envp)
{
  int v3; // eax
  char Str[96]; // [rsp+20h] [rbp-80h] BYREF
  int v6; // [rsp+80h] [rbp-20h]
  int k; // [rsp+90h] [rbp-10h]
  int j; // [rsp+94h] [rbp-Ch]
  int i; // [rsp+98h] [rbp-8h]
  int v10; // [rsp+9Ch] [rbp-4h]

  _main(argc, argv, envp);
  puts("<---  moectf2021  --->");
  puts(" [A_game] Welcome to moectf2021.");
  puts("Let's play a game!");
  puts("Now input your answer, and if you are right, I will give you flag");
  printf("input : ");
  memset(Str, 0, sizeof(Str));
  v6 = 0;
  scanf("%s", Str);
  if ( strlen(Str) != 49 )
  {
    puts("It's not enough.");
    system("pause");
    exit(0);
  }
  v10 = 0;
  for ( i = 0; i <= 8; ++i )
  {
    for ( j = 0; j <= 8; ++j )
    {
      if ( !box[9 * i + j] )
      {
        v3 = v10++;
        box[9 * i + j] = Str[v3] - 48;
      }
    }
  }
  check1();
  check2();
  check3();
  puts("Congratulations!!!!");
  puts("Enjoy the beauty of reverse and sudoku!");
  printf("And here is your flag : moectf{");
  for ( k = 0; k < strlen(Str); ++k )
    putchar(Str[k] ^ magic[k]);
  putchar(125);
  return 0;
}
```
+ è€ƒéªŒæˆ‘çš„è‹±è¯­æ°´å¹³ä¹ˆ,æœ‰ç‚¹...ä¸æäº†ä¸æäº†
+ æ€»ä¹‹,æˆ‘åœ¨ä¸‹é¢çœ‹åˆ°ä¸€å¥å¾ˆå…³é”®çš„æ–°æ¶ˆæ¯
+ Enjoy the beauty of reverse and sudoku
+ sudoku,æ­£å¥½æˆ‘åœ¨ä¸Šä¸ªæœˆåœ¨ç©çš„å­¦ç”Ÿæ—¶ä»£é‡Œè§è¿‡(è¿™ä¹ˆæ‰¯çš„å—?ä¸–ç•Œçº¿æ˜¯æ€ä¹ˆå›äº‹?)
+ ä¹Ÿæ˜¯æ‹œæ­¤æ‰€èµ,æˆ‘ä¸€ä¸‹å°±è®¤å‡ºäº†è¿™æ˜¯æ•°ç‹¬
+ æ¥ä¸‹æ¥è§‚å¯Ÿæ•´ä½“å†…å®¹,é¦–å…ˆæŠŠstræ¸…é›¶äº†
+ æŠŠv6èµ‹å€¼æˆ0,æ¥ä¸‹æ¥ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¯»å…¥str,ä¸æ˜¯49ä¸ªå°±é€€å‡ºç³»ç»Ÿ
+ æ˜¯çš„è¯æŠŠv10èµ‹ä¸º0,ä¼¼ä¹æ˜¯åœ¨å¡«å……ä¸€ä¸ªäºŒç»´æ•°ç»„,åº”è¯¥å°±æ˜¯æ•°ç‹¬è¡¨äº†
+ ä¸€ç»´ç´¢å¼• = åˆ—æ•° Ã— è¡Œå· + åˆ—å·
+ æ‰€ä»¥ä¸­é—´é‚£æ®µçš„æ„æ€æ˜¯boxè¿™æ®µå¦‚æœæ˜¯0çš„è¯å°±å¾—åˆ°ä¸€ä¸ªè§’æ ‡å€¼,ç„¶åè§’æ ‡è‡ªå¢
+ box[9 * i + j] = Str[v3] - 48;
+ åœ¨å½“å‰è§’æ ‡ä¸‹å–strå¯¹åº”çš„æ•°å­—å€¼(åœ¨ASCIIç¼–ç ä¸­æ•°å­—å­—ç¬¦'0'åˆ°'9'çš„ç¼–ç æ˜¯è¿ç»­çš„48-57å‡å»48å°±æ˜¯å°†å­—ç¬¦è½¬æ¢ä¸ºå¯¹åº”çš„æ•°å€¼)
+ æ¥ä¸‹æ¥ç»è¿‡ä¸‰è½®æ£€æŸ¥,å°±æ˜¯è¡Œåˆ—ä¸é‡å¤ä¸”åŒå’Œ,æˆ‘ä»¬å·²ç»çŸ¥é“äº†å°±ä¸ç”¨çœ‹äº†
+ æœ€åå°†æˆ‘ä»¬çš„è¾“å…¥å’Œmagicæ•°ç»„å¼‚æˆ–ä¹‹åputchar
+ è·Ÿè¿›box
![alt text](image.png)
+ å‘ç°è¿™å“¥ä»¬é•¿å¾—ç¡®å®æŒºçœ¼ç†Ÿçš„,ä¸å°±æ˜¯è¿·å®«é¢˜å—?!,ç›´æ¥ç»™æˆ‘å‡ºæ¥
```
data[96] =
{
  0,
  0,
  5,
  0,
  0,
  4,
  3,
  6,
  0,
  0,
  0,
  0,
  0,
  5,
  0,
  0,
  2,
  4,
  0,
  4,
  9,
  6,
  7,
  0,
  0,
  0,
  0,
  1,
  0,
  6,
  0,
  2,
  0,
  0,
  3,
  0,
  9,
  0,
  0,
  7,
  0,
  0,
  1,
  0,
  8,
  0,
  3,
  0,
  0,
  0,
  5,
  0,
  9,
  0,
  2,
  0,
  0,
  5,
  0,
  7,
  0,
  0,
  9,
  7,
  0,
  4,
  0,
  0,
  0,
  8,
  0,
  0,
  0,
  9,
  0,
  0,
  4,
  0,
  0,
  0,
  6,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0,
  0
};
```
+ å»è¯·è¿·å®«è„šæœ¬å‡ºå±±
```
for i in range(0,len(data)):
    print(data[i], end=',')
    if (i) % 9 == 0:
        print()
    if (i) % 81 == 0:
        print("------------")
```
+ ç¨åŠ ä¿®æ”¹ä¹‹åå¯åŠ¨,ç„¶åç©ä¼šæ•°ç‹¬å…ˆ
+ ...
+ å¥½,8291767138932581849755263447186268341129653538127,49ä¸ª,å®Œç¾åŒ¹é…å‰æ–‡
+ è·Ÿè¿›magic
```
unsigned char magic[] =
{
  0x6B, 0x02, 0x66, 0x70, 0x44, 0x69, 0x7E, 0x6E, 0x43, 0x4A, 
  0x78, 0x4A, 0x6D, 0x60, 0x56, 0x00, 0x51, 0x59, 0x50, 0x43, 
  0x50, 0x51, 0x6D, 0x74, 0x02, 0x55, 0x50, 0x52, 0x6E, 0x6F, 
  0x79, 0x40, 0x5D, 0x4B, 0x1E, 0x19, 0x1C, 0x74, 0x03, 0x54, 
  0x07, 0x4C, 0x52, 0x6A, 0x60, 0x50, 0x58, 0x40, 0x58, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00
};
```
+ å¥½,é‚£å°±å¼€å§‹ç¼–çº‚è„šæœ¬,ä¸ºäº†èƒ½æŠŠå®ƒä»¬é€ä¸ªå¯¹åº”,åœ¨cyberchefé‡Œçƒ¹é¥ªä¸€ä¸‹str
```
enc=[0x38,0x32,0x39,0x31,0x37,0x36,0x37,0x31,0x33,0x38,0x39,0x33,0x32,0x35,0x38,0x31,0x38,0x34,0x39,0x37,0x35,0x35,0x32,0x36,0x33,0x34,0x34,0x37,0x31,0x38,0x36,0x32,0x36,0x38,0x33,0x34,0x31,0x31,0x32,0x39,0x36,0x35,0x33,0x35,0x33,0x38,0x31,0x32,0x37]
data = [
  0x6B, 0x02, 0x66, 0x70, 0x44, 0x69, 0x7E, 0x6E, 0x43, 0x4A, 
  0x78, 0x4A, 0x6D, 0x60, 0x56, 0x00, 0x51, 0x59, 0x50, 0x43, 
  0x50, 0x51, 0x6D, 0x74, 0x02, 0x55, 0x50, 0x52, 0x6E, 0x6F, 
  0x79, 0x40, 0x5D, 0x4B, 0x1E, 0x19, 0x1C, 0x74, 0x03, 0x54, 
  0x07, 0x4C, 0x52, 0x6A, 0x60, 0x50, 0x58, 0x40, 0x58, 0x00, 
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
  0x00, 0x00, 0x00, 0x00
]

flag = ''.join(chr(enc[i] ^ data[i]) for i in range(len(enc)))
print(flag)
```
+ è¿è¡Œ,å¯åŠ¨,æˆåŠŸ,åŒ…å£³,æäº¤,æ‹¿é‡‘å¸
# æœ¬å‘¨å­¦ä¹ æ€»ç»“</font>
+ åšäº†ä¸€äº›é¢˜
+ å­¦äº†ä¸€äº›æ±‡ç¼–,ä¸»è¦è¿˜æ˜¯å¤ä¹ äº†cè¯­è¨€
# æ‚é¡¹</font>
+ NULL...